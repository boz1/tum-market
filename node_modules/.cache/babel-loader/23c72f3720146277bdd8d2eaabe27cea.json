{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\JFrancisco\\\\Documents\\\\tum-market\\\\src\\\\components\\\\Navbar.js\";\nimport React, { Component } from 'react';\nimport { Link } from 'react-router-dom';\nimport firebase from '../config/firebaseConfig';\nimport logo from \"../assests/logo.svg\";\nimport Button from 'react-bootstrap/Button';\nimport Form from 'react-bootstrap/Form';\nimport FormControl from 'react-bootstrap/FormControl';\nimport Dropdown from 'react-bootstrap/Dropdown';\nimport history from '../history';\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\nimport { faBell } from '@fortawesome/free-solid-svg-icons';\nimport { faTimes } from '@fortawesome/free-solid-svg-icons';\nimport Filter from './Filter';\nexport default class Navbar extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      notifications: [],\n      notificationIds: [],\n      isRead: true\n    };\n    this.logout = this.logout.bind(this);\n    this.readNotifications = this.readNotifications.bind(this);\n    this.getNotification = this.getNotification.bind(this);\n    this.deleteNotification = this.deleteNotification.bind(this);\n  }\n\n  componentWillUnmount() {\n    if (this.notifRef !== undefined) {\n      this.notifRef.off('value');\n      this.notifRef = null;\n    }\n\n    if (this.removeNotifRef !== undefined) {\n      this.removeNotifRef.off('value');\n      this.removeNotifRef = null;\n    }\n\n    if (this.notifReadRef !== undefined) {\n      this.notifReadRef.off('value');\n      this.notifReadRef = null;\n    }\n  }\n\n  componentWillReceiveProps() {\n    if (this.props.user !== undefined && this.props.user.info !== undefined) {\n      this.notifRef = firebase.database().ref('notifications').child(this.props.user.info.id);\n      this.notifRef.on('child_added', snap => {\n        let id = snap.val().id;\n\n        if (!this.state.notificationIds.includes(id)) {\n          let isRead = snap.val().isRead;\n          let notification = snap.val();\n          let idObj = this.state.notificationIds;\n          let notifObj = this.state.notifications;\n          idObj.push(id);\n          notifObj.push(notification);\n          this.setState({\n            notifications: notifObj,\n            notificationIds: idObj,\n            isRead: isRead\n          });\n        }\n      });\n    }\n  }\n\n  logout() {\n    firebase.auth().signOut();\n    history.push('/');\n  }\n\n  readNotifications() {\n    if (this.props.user !== undefined && this.props.user.info !== undefined && !this.state.isRead) {\n      this.notifReadRef = firebase.database().ref('notifications').child(this.props.user.info.id).orderByChild('isRead').equalTo(false);\n      this.notifReadRef.on('value', function (snap) {\n        snap.forEach(function (notification) {\n          notification.ref.update({\n            isRead: true\n          });\n        });\n      });\n      this.setState({\n        isRead: true\n      });\n    }\n  }\n\n  getNotification(notification) {\n    return React.createElement(\"span\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 91\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"d-flex\",\n      style: {\n        padding: \"0.5rem\"\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 92\n      },\n      __self: this\n    }, React.createElement(Link, {\n      to: {\n        pathname: '/tradeRequests'\n      },\n      className: \"dropdown-item\",\n      style: {\n        padding: \"0.75rem\"\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 93\n      },\n      __self: this\n    }, notification.message, \" \"), React.createElement(\"div\", {\n      className: \"m-auto\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 94\n      },\n      __self: this\n    }, React.createElement(\"span\", {\n      className: \"float-right offer-reject\",\n      style: {\n        cursor: \"pointer\"\n      },\n      onClick: this.deleteNotification,\n      \"data-notification\": notification.id,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 95\n      },\n      __self: this\n    }, React.createElement(FontAwesomeIcon, {\n      icon: faTimes,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 95\n      },\n      __self: this\n    })))), React.createElement(\"hr\", {\n      style: {\n        margin: \"0rem 0rem\"\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 98\n      },\n      __self: this\n    }));\n  }\n\n  deleteNotification(e) {\n    if (this.props.user !== undefined && this.props.user.info !== undefined) {\n      let id = e.currentTarget.dataset.notification;\n      let ids = [];\n      let notifications = [];\n      this.state.notificationIds.forEach(function (notifId) {\n        if (notifId !== id) {\n          ids.push(notifId);\n        }\n      });\n      this.state.notifications.forEach(function (notif) {\n        if (notif.id !== id) {\n          notifications.push(notif);\n        }\n      });\n      this.setState({\n        notificationIds: ids,\n        notifications: notifications\n      });\n      this.removeNotifRef = firebase.database().ref('notifications').child(this.props.user.info.id).child(id).remove();\n    }\n  }\n\n  render() {\n    const user = this.props.user;\n    let notifications = [];\n    let bell;\n\n    if (!this.state.isRead) {\n      bell = React.createElement(\"span\", {\n        style: {\n          fontSize: \"18px\",\n          color: \"crimson\"\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 136\n        },\n        __self: this\n      }, React.createElement(FontAwesomeIcon, {\n        icon: faBell,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 136\n        },\n        __self: this\n      }));\n    } else {\n      bell = React.createElement(\"span\", {\n        style: {\n          fontSize: \"18px\"\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 139\n        },\n        __self: this\n      }, React.createElement(FontAwesomeIcon, {\n        icon: faBell,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 139\n        },\n        __self: this\n      }));\n    }\n\n    if (this.state.notificationIds.length > 0) {\n      this.state.notifications.map(notif => notifications.push(React.createElement(\"span\", {\n        key: notif.id,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 143\n        },\n        __self: this\n      }, this.getNotification(notif))));\n    } else {\n      notifications.push(React.createElement(Dropdown.Item, {\n        key: 'no-notif-key',\n        disabled: true,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 146\n        },\n        __self: this\n      }, \"No notifications.\"));\n    }\n\n    return React.createElement(\"nav\", {\n      className: \"navbar navbar-expand-sm px-sm-5 nav-back\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 150\n      },\n      __self: this\n    }, React.createElement(Link, {\n      to: \"/\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 151\n      },\n      __self: this\n    }, React.createElement(\"img\", {\n      src: logo,\n      alt: \"Tum Market\",\n      className: \"navbar-brand img-responsive\",\n      style: {\n        width: \"55px\"\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 152\n      },\n      __self: this\n    })), React.createElement(\"ul\", {\n      className: \"navbar-nav align-items-center\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 154\n      },\n      __self: this\n    }, React.createElement(\"li\", {\n      className: \"nav-item ml-5\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 155\n      },\n      __self: this\n    }, React.createElement(Link, {\n      to: \"/newAdvertisement\",\n      className: \"text-new-ad\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 156\n      },\n      __self: this\n    }, \"New Advertisement\"))), React.createElement(\"div\", {\n      className: \"ml-auto\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 159\n      },\n      __self: this\n    }, React.createElement(Form, {\n      inline: true,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 160\n      },\n      __self: this\n    }, React.createElement(FormControl, {\n      onChange: this.props.search,\n      placeholder: \"Type in Title, Item No, ...\",\n      className: \"mr-sm-2 search\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 161\n      },\n      __self: this\n    }))), React.createElement(Filter, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 164\n      },\n      __self: this\n    }), React.createElement(\"span\", {\n      className: \"ml-auto\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 165\n      },\n      __self: this\n    }, React.createElement(Dropdown, {\n      onToggle: this.readNotifications,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 166\n      },\n      __self: this\n    }, React.createElement(Dropdown.Toggle, {\n      variant: \"info\",\n      id: \"dropdown-basic\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 167\n      },\n      __self: this\n    }, bell), React.createElement(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 170\n      },\n      __self: this\n    }), React.createElement(Dropdown.Menu, {\n      alignRight: true,\n      className: \"p-0\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 173\n      },\n      __self: this\n    }, notifications))), React.createElement(\"span\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 178\n      },\n      __self: this\n    }), React.createElement(Dropdown, {\n      className: \"ml-auto\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 179\n      },\n      __self: this\n    }, React.createElement(Dropdown.Toggle, {\n      variant: \"primary\",\n      id: \"dropdown-basic\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 180\n      },\n      __self: this\n    }, user !== undefined && user.info !== undefined ? user.info.name : \"\"), React.createElement(Dropdown.Menu, {\n      alignRight: true,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 183\n      },\n      __self: this\n    }, React.createElement(Dropdown.Item, {\n      href: \"#/action-1\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 184\n      },\n      __self: this\n    }, \"Profile\"), React.createElement(Dropdown.Item, {\n      href: \"#/action-2\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 185\n      },\n      __self: this\n    }, \"My Advertisements\"), React.createElement(Dropdown.Item, {\n      href: \"#/action-3\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 186\n      },\n      __self: this\n    }, \"My Buying Requests\"), React.createElement(Link, {\n      to: {\n        pathname: '/tradeRequests'\n      },\n      className: \"dropdown-item\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 187\n      },\n      __self: this\n    }, \"My Trade Requests\"), React.createElement(Dropdown.Item, {\n      href: \"#/action-3\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 188\n      },\n      __self: this\n    }, \"Chat Bot\"), React.createElement(Dropdown.Divider, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 189\n      },\n      __self: this\n    }), React.createElement(Dropdown.Item, {\n      onClick: this.logout,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 190\n      },\n      __self: this\n    }, \"Log Out\"))));\n  }\n\n}","map":{"version":3,"sources":["C:\\Users\\JFrancisco\\Documents\\tum-market\\src\\components\\Navbar.js"],"names":["React","Component","Link","firebase","Button","Form","FormControl","Dropdown","history","FontAwesomeIcon","faBell","faTimes","Filter","Navbar","constructor","props","state","notifications","notificationIds","isRead","logout","bind","readNotifications","getNotification","deleteNotification","componentWillUnmount","notifRef","undefined","off","removeNotifRef","notifReadRef","componentWillReceiveProps","user","info","database","ref","child","id","on","snap","val","includes","notification","idObj","notifObj","push","setState","auth","signOut","orderByChild","equalTo","forEach","update","padding","pathname","message","cursor","margin","e","currentTarget","dataset","ids","notifId","notif","remove","render","bell","fontSize","color","length","map","logo","width","search","name"],"mappings":"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","sourcesContent":["import React, { Component } from 'react'\r\nimport { Link } from 'react-router-dom'\r\nimport firebase from '../config/firebaseConfig';\r\nimport logo from '../assests/logo.svg'\r\nimport Button from 'react-bootstrap/Button';\r\nimport Form from 'react-bootstrap/Form';\r\nimport FormControl from 'react-bootstrap/FormControl';\r\nimport Dropdown from 'react-bootstrap/Dropdown';\r\nimport history from '../history'\r\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome'\r\nimport { faBell } from '@fortawesome/free-solid-svg-icons'\r\nimport { faTimes } from '@fortawesome/free-solid-svg-icons'\r\nimport Filter from './Filter'\r\n\r\n\r\nexport default class Navbar extends Component {\r\n    constructor(props) {\r\n        super(props)\r\n        this.state = {\r\n            notifications: [],\r\n            notificationIds: [],\r\n            isRead: true\r\n        }\r\n\r\n        this.logout = this.logout.bind(this)\r\n        this.readNotifications = this.readNotifications.bind(this)\r\n        this.getNotification = this.getNotification.bind(this)\r\n        this.deleteNotification = this.deleteNotification.bind(this)\r\n    }\r\n\r\n    componentWillUnmount() {\r\n        if (this.notifRef !== undefined) {\r\n            this.notifRef.off('value')\r\n            this.notifRef = null;\r\n        }\r\n\r\n        if (this.removeNotifRef !== undefined) {\r\n            this.removeNotifRef.off('value')\r\n            this.removeNotifRef = null;\r\n        }\r\n\r\n        if (this.notifReadRef !== undefined) {\r\n            this.notifReadRef.off('value')\r\n            this.notifReadRef = null;\r\n        }\r\n    }\r\n\r\n    componentWillReceiveProps() {\r\n        if (this.props.user !== undefined && this.props.user.info !== undefined) {\r\n            this.notifRef = firebase.database().ref('notifications').child(this.props.user.info.id)\r\n            this.notifRef.on('child_added', snap => {\r\n                let id = snap.val().id;\r\n                if (!this.state.notificationIds.includes(id)) {\r\n                    let isRead = snap.val().isRead;\r\n                    let notification = snap.val();\r\n                    let idObj = this.state.notificationIds;\r\n                    let notifObj = this.state.notifications;\r\n                    idObj.push(id);\r\n                    notifObj.push(notification)\r\n                    this.setState({\r\n                        notifications: notifObj,\r\n                        notificationIds: idObj,\r\n                        isRead: isRead\r\n                    })\r\n                }\r\n            })\r\n        }\r\n    }\r\n\r\n    logout() {\r\n        firebase.auth().signOut();\r\n        history.push('/')\r\n    }\r\n\r\n    readNotifications() {\r\n        if (this.props.user !== undefined && this.props.user.info !== undefined && !this.state.isRead) {\r\n            this.notifReadRef = firebase.database().ref('notifications').child(this.props.user.info.id).orderByChild('isRead').equalTo(false)\r\n            this.notifReadRef.on('value', function (snap) {\r\n                snap.forEach(function (notification) {\r\n                    notification.ref.update({ isRead: true });\r\n                });\r\n            });\r\n\r\n            this.setState({\r\n                isRead: true\r\n            })\r\n        }\r\n    }\r\n\r\n    getNotification(notification) {\r\n        return <span>\r\n            <div className=\"d-flex\" style={{ padding: \"0.5rem\" }}>\r\n                <Link to={{ pathname: '/tradeRequests' }} className=\"dropdown-item\" style={{ padding: \"0.75rem\" }}>{notification.message} </Link>\r\n                <div className=\"m-auto\">\r\n                    <span className=\"float-right offer-reject\" style={{ cursor: \"pointer\" }} onClick={this.deleteNotification} data-notification={notification.id}><FontAwesomeIcon icon={faTimes} /></span>\r\n                </div>\r\n            </div>\r\n            <hr style={{ margin: \"0rem 0rem\" }}></hr>\r\n        </span>\r\n    }\r\n\r\n    deleteNotification(e) {\r\n        if (this.props.user !== undefined && this.props.user.info !== undefined) {\r\n            let id = e.currentTarget.dataset.notification;\r\n            let ids = [];\r\n            let notifications = [];\r\n\r\n            this.state.notificationIds.forEach(function(notifId){\r\n                if(notifId !== id){\r\n                    ids.push(notifId)\r\n                }\r\n            })\r\n\r\n            this.state.notifications.forEach(function(notif){\r\n                if(notif.id !== id){\r\n                    notifications.push(notif)\r\n                }\r\n            })\r\n\r\n\r\n            this.setState({\r\n                notificationIds: ids,\r\n                notifications: notifications\r\n            })\r\n\r\n            this.removeNotifRef = firebase.database().ref('notifications').child(this.props.user.info.id).child(id).remove();\r\n        }\r\n    }\r\n\r\n    render() {\r\n        const user = this.props.user;\r\n        let notifications = [];\r\n        let bell;\r\n\r\n        if (!this.state.isRead) {\r\n            bell = <span style={{ fontSize: \"18px\", color: \"crimson\" }}><FontAwesomeIcon icon={faBell} /></span>\r\n        }\r\n        else {\r\n            bell = <span style={{ fontSize: \"18px\" }}><FontAwesomeIcon icon={faBell} /></span>\r\n        }\r\n\r\n        if (this.state.notificationIds.length > 0) {\r\n            this.state.notifications.map((notif) => notifications.push(<span key={notif.id}>{this.getNotification(notif)}</span>))\r\n        }\r\n        else {\r\n            notifications.push(<Dropdown.Item key={'no-notif-key'} disabled>No notifications.</Dropdown.Item>)\r\n        }\r\n\r\n        return (\r\n            <nav className=\"navbar navbar-expand-sm px-sm-5 nav-back\">\r\n                <Link to='/'>\r\n                    <img src={logo} alt=\"Tum Market\" className=\"navbar-brand img-responsive\" style={{ width: \"55px\" }} />\r\n                </Link>\r\n                <ul className=\"navbar-nav align-items-center\">\r\n                    <li className=\"nav-item ml-5\">\r\n                        <Link to=\"/newAdvertisement\" className=\"text-new-ad\">New Advertisement</Link>\r\n                    </li>\r\n                </ul>\r\n                <div className=\"ml-auto\">\r\n                    <Form inline>\r\n                        <FormControl onChange={this.props.search} placeholder=\"Type in Title, Item No, ...\" className=\"mr-sm-2 search\" />\r\n                    </Form>\r\n                </div>\r\n                <Filter/>\r\n                <span className=\"ml-auto\">\r\n                    <Dropdown onToggle={this.readNotifications}>\r\n                        <Dropdown.Toggle variant=\"info\" id=\"dropdown-basic\" >\r\n                            {bell}\r\n                        </Dropdown.Toggle>\r\n                        <div >\r\n\r\n                        </div>\r\n                        <Dropdown.Menu alignRight className=\"p-0\">\r\n                            {notifications}\r\n                        </Dropdown.Menu>\r\n                    </Dropdown>\r\n                </span>\r\n                <span></span>\r\n                <Dropdown className=\"ml-auto\">\r\n                    <Dropdown.Toggle variant=\"primary\" id=\"dropdown-basic\">\r\n                        {user !== undefined && user.info !== undefined ? user.info.name : \"\"}\r\n                    </Dropdown.Toggle>\r\n                    <Dropdown.Menu alignRight>\r\n                        <Dropdown.Item href=\"#/action-1\">Profile</Dropdown.Item>\r\n                        <Dropdown.Item href=\"#/action-2\">My Advertisements</Dropdown.Item>\r\n                        <Dropdown.Item href=\"#/action-3\">My Buying Requests</Dropdown.Item>\r\n                        <Link to={{ pathname: '/tradeRequests' }} className=\"dropdown-item\">My Trade Requests</Link>\r\n                        <Dropdown.Item href=\"#/action-3\">Chat Bot</Dropdown.Item>\r\n                        <Dropdown.Divider />\r\n                        <Dropdown.Item onClick={this.logout}>Log Out</Dropdown.Item>\r\n                    </Dropdown.Menu>\r\n                </Dropdown>\r\n            </nav>\r\n        )\r\n    }\r\n}"]},"metadata":{},"sourceType":"module"}