{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\JFrancisco\\\\Documents\\\\tum-market\\\\src\\\\components\\\\trade\\\\TradeRequest.js\";\nimport React, { Component } from 'react';\nimport firebase from '../../config/firebaseConfig';\nimport Card from 'react-bootstrap/Card';\nimport ConfirmationModal from '../ConfirmationModal';\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\nimport { faCheck } from '@fortawesome/free-solid-svg-icons';\nimport { faTimes } from '@fortawesome/free-solid-svg-icons';\nexport default class TradeRequest extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      receivedItem: {},\n      sentItem: {},\n      otherParty: {},\n      showStatusModal: false,\n      showDeleteModal: false,\n      statusAction: '',\n      status: this.props.item.status\n    };\n    this.setItems = this.setItems.bind(this);\n    this.showStatusModal = this.showStatusModal.bind(this);\n    this.handleClose = this.handleClose.bind(this);\n    this.handleSubmit = this.handleSubmit.bind(this);\n    this.showDeleteModal = this.showDeleteModal.bind(this);\n    this.handleDeleteClose = this.handleDeleteClose.bind(this);\n    this.handleDeleteSubmit = this.handleDeleteSubmit.bind(this);\n  }\n\n  componentDidMount() {\n    this.setItems();\n  }\n\n  componentWillUnmount() {\n    this.receivedRef.off('value');\n    this.receivedRef = null;\n    this.sentItemRef.off('value');\n    this.sentItemRef = null;\n    this.otherPartyRef.off('value');\n    this.otherPartyRef = null;\n  }\n\n  setItems() {\n    const item = this.props.item;\n\n    if (this.props.type === \"received\") {\n      this.receivedRef = firebase.database().ref('advertisements').child(item.buyerId).child(item.receivedItemId);\n      this.receivedRef.on('value', snap => {\n        this.setState({\n          receivedItem: snap.val()\n        });\n      });\n      this.sentItemRef = firebase.database().ref('advertisements').child(item.userId).child(item.sentItemId);\n      this.sentItemRef.on('value', snap => {\n        this.setState({\n          sentItem: snap.val()\n        });\n      });\n      this.otherPartyRef = firebase.database().ref('users').child(item.buyerId);\n      this.otherPartyRef.on('value', snap => {\n        this.setState({\n          otherParty: snap.val()\n        });\n      });\n    }\n\n    if (this.props.type === \"sent\") {\n      this.receivedRef = firebase.database().ref('advertisements').child(item.sellerId).child(item.targetItemId);\n      this.receivedRef.on('value', snap => {\n        this.setState({\n          receivedItem: snap.val()\n        });\n      });\n      this.sentItemRef = firebase.database().ref('advertisements').child(item.userId).child(item.offeredItemId);\n      this.sentItemRef.on('value', snap => {\n        this.setState({\n          sentItem: snap.val()\n        });\n      });\n      this.otherPartyRef = firebase.database().ref('users').child(item.sellerId);\n      this.otherPartyRef.on('value', snap => {\n        this.setState({\n          otherParty: snap.val()\n        });\n      });\n      this.setState({\n        status: this.props.item.status\n      });\n    }\n  }\n\n  showDeleteModal() {\n    this.setState({\n      showDeleteModal: true\n    });\n  }\n\n  handleDeleteClose() {\n    this.setState({\n      showDeleteModal: false\n    });\n  }\n\n  handleDeleteSubmit() {\n    this.setState({\n      showDeleteModal: false\n    });\n    var newPostKey = firebase.database().ref('notifications').child(this.props.item.sellerId).push().key;\n    const notification = {\n      id: newPostKey,\n      message: this.props.user.name + \" has deleted their trade request for your \" + this.state.receivedItem.title + \".\",\n      isRead: false\n    };\n    var updates = {};\n    updates['/notifications/' + this.props.item.sellerId + '/' + newPostKey] = notification;\n    firebase.database().ref().update(updates);\n    firebase.database().ref('trade-requests').child(this.props.item.userId).child(this.props.item.id).remove();\n    firebase.database().ref('received-offers').child(this.props.item.sellerId).child(this.props.item.id).remove();\n  }\n\n  showStatusModal(e) {\n    this.setState({\n      showStatusModal: true,\n      statusAction: e.currentTarget.dataset.span\n    });\n  }\n\n  handleClose() {\n    this.setState({\n      showStatusModal: false\n    });\n  }\n\n  handleSubmit(e) {\n    this.setState({\n      showStatusModal: false,\n      status: e.target.value\n    }); // Get a key for a new Post.\n\n    var newPostKey = firebase.database().ref('notifications').child(this.props.item.buyerId).push().key;\n    const notification = {\n      id: newPostKey,\n      message: this.props.user.name + \" has \" + this.state.statusAction.toLowerCase() + \" your trade request for \" + this.state.sentItem.title + \".\",\n      isRead: false\n    };\n    var updates = {};\n    updates['/trade-requests/' + this.props.item.buyerId + '/' + this.props.item.id + '/status'] = e.target.value;\n    updates['/received-offers/' + this.props.item.userId + '/' + this.props.item.id + '/status'] = e.target.value;\n    updates['/notifications/' + this.props.item.buyerId + '/' + newPostKey] = notification;\n    firebase.database().ref().update(updates);\n  }\n\n  render() {\n    const item = this.props.item;\n    const type = this.props.type;\n    let request, receivedStatus, sentStatus, statusUpdateModal, deleteModal, statusAction;\n\n    if (this.state.statusAction === \"Accepted\") {\n      statusAction = \"accept\";\n    } else {\n      statusAction = \"reject\";\n    }\n\n    const updateTxt = React.createElement(\"span\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 178\n      },\n      __self: this\n    }, \"Do you want to \", React.createElement(\"strong\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 178\n      },\n      __self: this\n    }, statusAction), \" this offer?\");\n    statusUpdateModal = React.createElement(ConfirmationModal, {\n      show: this.state.showStatusModal,\n      onHide: this.handleClose,\n      title: \"Status Update\",\n      txt: updateTxt,\n      onClickClose: this.handleClose,\n      onClickConfirm: this.handleSubmit,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 179\n      },\n      __self: this\n    });\n    deleteModal = React.createElement(ConfirmationModal, {\n      show: this.state.showDeleteModal,\n      onHide: this.handleClose,\n      title: \"Delete Request\",\n      txt: \"Do you want to delete this request?\",\n      onClickClose: this.handleDeleteClose,\n      onClickConfirm: this.handleDeleteSubmit,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 181\n      },\n      __self: this\n    });\n\n    if (this.state.status === \"Accepted\") {\n      receivedStatus = React.createElement(\"span\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 185\n        },\n        __self: this\n      }, React.createElement(\"span\", {\n        className: \"float-right offer-accept ml-3 accepted\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 186\n        },\n        __self: this\n      }, React.createElement(FontAwesomeIcon, {\n        icon: faCheck,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 186\n        },\n        __self: this\n      })), React.createElement(\"span\", {\n        className: \"float-right offer-reject\",\n        style: {\n          cursor: \"pointer\"\n        },\n        onClick: this.showStatusModal,\n        \"data-span\": \"Rejected\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 187\n        },\n        __self: this\n      }, React.createElement(FontAwesomeIcon, {\n        icon: faTimes,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 187\n        },\n        __self: this\n      })));\n    } else if (this.state.status === \"Rejected\") {\n      receivedStatus = React.createElement(\"span\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 192\n        },\n        __self: this\n      }, React.createElement(\"span\", {\n        className: \"float-right offer-accept ml-3\",\n        style: {\n          cursor: \"pointer\"\n        },\n        onClick: this.showStatusModal,\n        \"data-span\": \"Accepted\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 193\n        },\n        __self: this\n      }, React.createElement(FontAwesomeIcon, {\n        icon: faCheck,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 193\n        },\n        __self: this\n      })), React.createElement(\"span\", {\n        className: \"float-right offer-reject rejected\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 194\n        },\n        __self: this\n      }, React.createElement(FontAwesomeIcon, {\n        icon: faTimes,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 194\n        },\n        __self: this\n      })));\n    } else {\n      receivedStatus = React.createElement(\"span\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 199\n        },\n        __self: this\n      }, React.createElement(\"span\", {\n        className: \"float-right offer-accept ml-3\",\n        style: {\n          cursor: \"pointer\"\n        },\n        onClick: this.showStatusModal,\n        \"data-span\": \"Accepted\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 200\n        },\n        __self: this\n      }, React.createElement(FontAwesomeIcon, {\n        icon: faCheck,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 200\n        },\n        __self: this\n      })), React.createElement(\"span\", {\n        className: \"float-right offer-reject\",\n        style: {\n          cursor: \"pointer\"\n        },\n        onClick: this.showStatusModal,\n        \"data-span\": \"Rejected\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 201\n        },\n        __self: this\n      }, React.createElement(FontAwesomeIcon, {\n        icon: faTimes,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 201\n        },\n        __self: this\n      })));\n    }\n\n    sentStatus = React.createElement(\"span\", {\n      className: \"float-right offer-reject\",\n      style: {\n        cursor: \"pointer\"\n      },\n      onClick: this.showDeleteModal,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 205\n      },\n      __self: this\n    }, React.createElement(FontAwesomeIcon, {\n      icon: faTimes,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 205\n      },\n      __self: this\n    }));\n\n    if (type === \"received\") {\n      request = React.createElement(Card, {\n        className: \"w-100 h-auto\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 208\n        },\n        __self: this\n      }, React.createElement(Card.Header, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 209\n        },\n        __self: this\n      }, React.createElement(\"span\", {\n        className: \"text-sub-title\",\n        style: {\n          color: \"coral\"\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 210\n        },\n        __self: this\n      }, \"Received Offer\", receivedStatus)), React.createElement(Card.Body, {\n        style: {\n          background: \"#FFE7DF\"\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 214\n        },\n        __self: this\n      }, React.createElement(Card.Text, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 215\n        },\n        __self: this\n      }, \"Receive Item: \", React.createElement(\"strong\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 216\n        },\n        __self: this\n      }, this.state.receivedItem.title)), React.createElement(Card.Text, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 218\n        },\n        __self: this\n      }, \"Received Item Id: \", React.createElement(\"strong\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 219\n        },\n        __self: this\n      }, this.state.receivedItem.id)), React.createElement(Card.Text, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 221\n        },\n        __self: this\n      }, \"Sent Item: \", React.createElement(\"strong\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 222\n        },\n        __self: this\n      }, this.state.sentItem.title)), React.createElement(Card.Text, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 224\n        },\n        __self: this\n      }, \"Sent Item Id: \", React.createElement(\"strong\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 225\n        },\n        __self: this\n      }, this.state.sentItem.id)), React.createElement(Card.Text, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 227\n        },\n        __self: this\n      }, \"From: \", React.createElement(\"strong\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 228\n        },\n        __self: this\n      }, this.state.otherParty.name, \" - \", this.state.otherParty.email)), React.createElement(Card.Text, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 230\n        },\n        __self: this\n      }, \"Status: \", React.createElement(\"strong\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 231\n        },\n        __self: this\n      }, item.status)), React.createElement(Card.Text, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 233\n        },\n        __self: this\n      }, \"Date: \", React.createElement(\"strong\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 234\n        },\n        __self: this\n      }, item.date.split(\" \")[0]))));\n    } else if (type === \"sent\") {\n      request = React.createElement(Card, {\n        className: \"w-100 h-auto mt-2\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 240\n        },\n        __self: this\n      }, React.createElement(Card.Header, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 241\n        },\n        __self: this\n      }, React.createElement(\"span\", {\n        className: \"text-sub-title\",\n        style: {\n          color: \"#3DA09B\"\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 242\n        },\n        __self: this\n      }, \"Sent Offer\", sentStatus)), React.createElement(Card.Body, {\n        style: {\n          background: \"#DBEDEC\"\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 246\n        },\n        __self: this\n      }, React.createElement(Card.Text, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 247\n        },\n        __self: this\n      }, \"Received Item: \", React.createElement(\"strong\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 248\n        },\n        __self: this\n      }, this.state.receivedItem.title)), React.createElement(Card.Text, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 250\n        },\n        __self: this\n      }, \"Received Item Id: \", React.createElement(\"strong\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 251\n        },\n        __self: this\n      }, this.state.receivedItem.id)), React.createElement(Card.Text, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 253\n        },\n        __self: this\n      }, \"Sent Item: \", React.createElement(\"strong\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 254\n        },\n        __self: this\n      }, this.state.sentItem.title)), React.createElement(Card.Text, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 256\n        },\n        __self: this\n      }, \"Sent Item Id: \", React.createElement(\"strong\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 257\n        },\n        __self: this\n      }, this.state.sentItem.id)), React.createElement(Card.Text, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 259\n        },\n        __self: this\n      }, \"To: \", React.createElement(\"strong\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 260\n        },\n        __self: this\n      }, this.state.otherParty.name, \" - \", this.state.otherParty.email)), React.createElement(Card.Text, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 262\n        },\n        __self: this\n      }, \"Status: \", React.createElement(\"strong\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 263\n        },\n        __self: this\n      }, item.status)), React.createElement(Card.Text, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 265\n        },\n        __self: this\n      }, \"Date: \", React.createElement(\"strong\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 266\n        },\n        __self: this\n      }, item.date.split(\" \")[0]))));\n    }\n\n    return React.createElement(\"div\", {\n      className: \"mr-2\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 273\n      },\n      __self: this\n    }, deleteModal, statusUpdateModal, request);\n  }\n\n}","map":{"version":3,"sources":["C:\\Users\\JFrancisco\\Documents\\tum-market\\src\\components\\trade\\TradeRequest.js"],"names":["React","Component","firebase","Card","ConfirmationModal","FontAwesomeIcon","faCheck","faTimes","TradeRequest","constructor","props","state","receivedItem","sentItem","otherParty","showStatusModal","showDeleteModal","statusAction","status","item","setItems","bind","handleClose","handleSubmit","handleDeleteClose","handleDeleteSubmit","componentDidMount","componentWillUnmount","receivedRef","off","sentItemRef","otherPartyRef","type","database","ref","child","buyerId","receivedItemId","on","snap","setState","val","userId","sentItemId","sellerId","targetItemId","offeredItemId","newPostKey","push","key","notification","id","message","user","name","title","isRead","updates","update","remove","e","currentTarget","dataset","span","target","value","toLowerCase","render","request","receivedStatus","sentStatus","statusUpdateModal","deleteModal","updateTxt","cursor","color","background","email","date","split"],"mappings":"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","sourcesContent":["import React, { Component } from 'react'\r\nimport firebase from '../../config/firebaseConfig';\r\nimport Card from 'react-bootstrap/Card';\r\nimport ConfirmationModal from '../ConfirmationModal' \r\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome'\r\nimport { faCheck } from '@fortawesome/free-solid-svg-icons'\r\nimport { faTimes } from '@fortawesome/free-solid-svg-icons'\r\n\r\nexport default class TradeRequest extends Component {\r\n    constructor(props) {\r\n        super(props)\r\n        this.state = {\r\n            receivedItem: {},\r\n            sentItem: {},\r\n            otherParty: {},\r\n            showStatusModal: false,\r\n            showDeleteModal: false,\r\n            statusAction: '',\r\n            status: this.props.item.status\r\n        }\r\n\r\n        this.setItems = this.setItems.bind(this)\r\n\r\n        this.showStatusModal = this.showStatusModal.bind(this)\r\n        this.handleClose = this.handleClose.bind(this)\r\n        this.handleSubmit = this.handleSubmit.bind(this)\r\n\r\n        this.showDeleteModal = this.showDeleteModal.bind(this)\r\n        this.handleDeleteClose = this.handleDeleteClose.bind(this)\r\n        this.handleDeleteSubmit = this.handleDeleteSubmit.bind(this)\r\n    }\r\n\r\n    componentDidMount() {\r\n        this.setItems()\r\n    }\r\n\r\n    componentWillUnmount() {\r\n        this.receivedRef.off('value')\r\n        this.receivedRef = null;\r\n\r\n        this.sentItemRef.off('value')\r\n        this.sentItemRef = null;\r\n\r\n        this.otherPartyRef.off('value')\r\n        this.otherPartyRef = null;\r\n    }\r\n\r\n    setItems() {\r\n        const item = this.props.item;\r\n\r\n        if (this.props.type === \"received\") {\r\n            this.receivedRef = firebase.database().ref('advertisements').child(item.buyerId).child(item.receivedItemId)\r\n            this.receivedRef.on('value', snap => {\r\n                this.setState({\r\n                    receivedItem: snap.val()\r\n                })\r\n            })\r\n\r\n            this.sentItemRef = firebase.database().ref('advertisements').child(item.userId).child(item.sentItemId)\r\n            this.sentItemRef.on('value', snap => {\r\n                this.setState({\r\n                    sentItem: snap.val()\r\n                })\r\n            })\r\n\r\n            this.otherPartyRef = firebase.database().ref('users').child(item.buyerId)\r\n            this.otherPartyRef.on('value', snap => {\r\n                this.setState({\r\n                    otherParty: snap.val()\r\n                })\r\n            })\r\n        }\r\n\r\n        if (this.props.type === \"sent\") {\r\n            this.receivedRef = firebase.database().ref('advertisements').child(item.sellerId).child(item.targetItemId)\r\n            this.receivedRef.on('value', snap => {\r\n                this.setState({\r\n                    receivedItem: snap.val()\r\n                })\r\n            })\r\n\r\n            this.sentItemRef = firebase.database().ref('advertisements').child(item.userId).child(item.offeredItemId)\r\n            this.sentItemRef.on('value', snap => {\r\n                this.setState({\r\n                    sentItem: snap.val()\r\n                })\r\n            })\r\n\r\n            this.otherPartyRef = firebase.database().ref('users').child(item.sellerId)\r\n            this.otherPartyRef.on('value', snap => {\r\n                this.setState({\r\n                    otherParty: snap.val()\r\n                })\r\n            })\r\n\r\n            this.setState({\r\n                status: this.props.item.status\r\n            })\r\n        }\r\n    }\r\n\r\n    showDeleteModal() {\r\n        this.setState({\r\n            showDeleteModal: true\r\n        })\r\n    }\r\n\r\n    handleDeleteClose() {\r\n        this.setState({ showDeleteModal: false });\r\n    }\r\n\r\n    handleDeleteSubmit() {\r\n        this.setState({\r\n            showDeleteModal: false\r\n        });\r\n\r\n        var newPostKey = firebase.database().ref('notifications').child(this.props.item.sellerId).push().key;\r\n\r\n        const notification = {\r\n            id: newPostKey,\r\n            message: this.props.user.name + \" has deleted their trade request for your \" + this.state.receivedItem.title + \".\",\r\n            isRead: false\r\n        };\r\n\r\n        var updates = {};\r\n        updates['/notifications/' + this.props.item.sellerId + '/' + newPostKey] = notification;\r\n        firebase.database().ref().update(updates);\r\n\r\n        firebase.database().ref('trade-requests').child(this.props.item.userId).child(this.props.item.id).remove();\r\n        firebase.database().ref('received-offers').child(this.props.item.sellerId).child(this.props.item.id).remove();\r\n    }\r\n\r\n    showStatusModal(e) {\r\n        this.setState({\r\n            showStatusModal: true,\r\n            statusAction: e.currentTarget.dataset.span\r\n        })\r\n    }\r\n\r\n    handleClose() {\r\n        this.setState({ showStatusModal: false });\r\n    }\r\n\r\n    handleSubmit(e) {\r\n        this.setState({\r\n            showStatusModal: false,\r\n            status: e.target.value\r\n        });\r\n\r\n        // Get a key for a new Post.\r\n        var newPostKey = firebase.database().ref('notifications').child(this.props.item.buyerId).push().key;\r\n\r\n        const notification = {\r\n            id: newPostKey,\r\n            message: this.props.user.name + \" has \" + this.state.statusAction.toLowerCase() + \" your trade request for \" + this.state.sentItem.title + \".\",\r\n            isRead: false\r\n        };\r\n\r\n        var updates = {};\r\n        updates['/trade-requests/' + this.props.item.buyerId + '/' + this.props.item.id + '/status'] = e.target.value;\r\n        updates['/received-offers/' + this.props.item.userId + '/' + this.props.item.id + '/status'] = e.target.value;\r\n        updates['/notifications/' + this.props.item.buyerId + '/' + newPostKey] = notification;\r\n\r\n        firebase.database().ref().update(updates);\r\n    }\r\n\r\n    render() {\r\n        const item = this.props.item;\r\n        const type = this.props.type;\r\n        let request, receivedStatus, sentStatus, statusUpdateModal, deleteModal, statusAction;\r\n\r\n        if (this.state.statusAction === \"Accepted\") {\r\n            statusAction = \"accept\"\r\n        } else {\r\n            statusAction = \"reject\"\r\n        }\r\n\r\n        const updateTxt = <span>Do you want to <strong>{statusAction}</strong> this offer?</span>\r\n        statusUpdateModal = <ConfirmationModal show={this.state.showStatusModal} onHide={this.handleClose} title=\"Status Update\" txt={updateTxt} onClickClose={this.handleClose} onClickConfirm={this.handleSubmit} />\r\n\r\n        deleteModal = <ConfirmationModal show={this.state.showDeleteModal} onHide={this.handleClose} title=\"Delete Request\" txt=\"Do you want to delete this request?\" onClickClose={this.handleDeleteClose} onClickConfirm={this.handleDeleteSubmit} />\r\n\r\n        if (this.state.status === \"Accepted\") {\r\n            receivedStatus =\r\n                <span>\r\n                    <span className=\"float-right offer-accept ml-3 accepted\"><FontAwesomeIcon icon={faCheck} /></span>\r\n                    <span className=\"float-right offer-reject\" style={{ cursor: \"pointer\" }} onClick={this.showStatusModal} data-span=\"Rejected\"><FontAwesomeIcon icon={faTimes} /></span>\r\n                </span>\r\n        }\r\n        else if (this.state.status === \"Rejected\") {\r\n            receivedStatus =\r\n                <span>\r\n                    <span className=\"float-right offer-accept ml-3\" style={{ cursor: \"pointer\" }} onClick={this.showStatusModal} data-span=\"Accepted\"><FontAwesomeIcon icon={faCheck} /></span>\r\n                    <span className=\"float-right offer-reject rejected\"><FontAwesomeIcon icon={faTimes} /></span>\r\n                </span>\r\n        }\r\n        else {\r\n            receivedStatus =\r\n                <span>\r\n                    <span className=\"float-right offer-accept ml-3\" style={{ cursor: \"pointer\" }} onClick={this.showStatusModal} data-span=\"Accepted\"><FontAwesomeIcon icon={faCheck} /></span>\r\n                    <span className=\"float-right offer-reject\" style={{ cursor: \"pointer\" }} onClick={this.showStatusModal} data-span=\"Rejected\"><FontAwesomeIcon icon={faTimes} /></span>\r\n                </span>\r\n        }\r\n\r\n        sentStatus = <span className=\"float-right offer-reject\" style={{ cursor: \"pointer\" }} onClick={this.showDeleteModal}><FontAwesomeIcon icon={faTimes} /></span>\r\n\r\n        if (type === \"received\") {\r\n            request = <Card className=\"w-100 h-auto\">\r\n                <Card.Header>\r\n                    <span className=\"text-sub-title\" style={{ color: \"coral\" }}>Received Offer\r\n                        {receivedStatus}\r\n                    </span>\r\n                </Card.Header>\r\n                <Card.Body style={{ background: \"#FFE7DF\" }}>\r\n                    <Card.Text>\r\n                        Receive Item: <strong>{this.state.receivedItem.title}</strong>\r\n                    </Card.Text>\r\n                    <Card.Text>\r\n                        Received Item Id: <strong>{this.state.receivedItem.id}</strong>\r\n                    </Card.Text>\r\n                    <Card.Text>\r\n                        Sent Item: <strong>{this.state.sentItem.title}</strong>\r\n                    </Card.Text>\r\n                    <Card.Text>\r\n                        Sent Item Id: <strong>{this.state.sentItem.id}</strong>\r\n                    </Card.Text>\r\n                    <Card.Text>\r\n                        From: <strong>{this.state.otherParty.name} - {this.state.otherParty.email}</strong>\r\n                    </Card.Text>\r\n                    <Card.Text>\r\n                        Status: <strong>{item.status}</strong>\r\n                    </Card.Text>\r\n                    <Card.Text>\r\n                        Date: <strong>{item.date.split(\" \")[0]}</strong>\r\n                    </Card.Text>\r\n                </Card.Body>\r\n            </Card>\r\n        }\r\n        else if (type === \"sent\") {\r\n            request = <Card className=\"w-100 h-auto mt-2\">\r\n                <Card.Header>\r\n                    <span className=\"text-sub-title\" style={{ color: \"#3DA09B\" }}>Sent Offer\r\n                        {sentStatus}\r\n                    </span>\r\n                </Card.Header>\r\n                <Card.Body style={{ background: \"#DBEDEC\" }}>\r\n                    <Card.Text>\r\n                        Received Item: <strong>{this.state.receivedItem.title}</strong>\r\n                    </Card.Text>\r\n                    <Card.Text>\r\n                        Received Item Id: <strong>{this.state.receivedItem.id}</strong>\r\n                    </Card.Text>\r\n                    <Card.Text>\r\n                        Sent Item: <strong>{this.state.sentItem.title}</strong>\r\n                    </Card.Text>\r\n                    <Card.Text>\r\n                        Sent Item Id: <strong>{this.state.sentItem.id}</strong>\r\n                    </Card.Text>\r\n                    <Card.Text>\r\n                        To: <strong>{this.state.otherParty.name} - {this.state.otherParty.email}</strong>\r\n                    </Card.Text>\r\n                    <Card.Text>\r\n                        Status: <strong>{item.status}</strong>\r\n                    </Card.Text>\r\n                    <Card.Text>\r\n                        Date: <strong>{item.date.split(\" \")[0]}</strong>\r\n                    </Card.Text>\r\n                </Card.Body>\r\n            </Card >\r\n        }\r\n\r\n        return (\r\n            <div className=\"mr-2\">\r\n                {deleteModal}\r\n                {statusUpdateModal}\r\n                {request}\r\n            </div>\r\n        )\r\n    }\r\n}\r\n"]},"metadata":{},"sourceType":"module"}